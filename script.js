// ==================== 您的“后台”数据中心 (手工校对生成) ====================
// ==================== 您的“后台”数据中心 (根据您提供的表格生成) ====================
const database = {
    windows: {
        music: [
            {
                name: "酷我音乐",
                icon: "images/kuwo.svg",
                versions: [
                    { name: "PC版", xunlei_url: "https://pan.xunlei.com/s/VOUmHGq_jsAyQQzfsqNYsXi5A1?pwd=i9u7", quark_url: "https://pan.quark.cn/s/229f5069c98a" }
                ]
            },
            {
                name: "Spotify",
                icon: "images/spotify.svg",
                versions: [
                    { name: "Spotify PC", xunlei_url: "https://pan.xunlei.com/s/VOUmI4ic-z01v_D6GUhqASi4A1?pwd=qmup", quark_url: "https://pan.quark.cn/s/6387325199a1" }
                ]
            }
        ],
        photo: [
            {
                name: "adobe全家桶一件安装版",
                icon: "images/adobe.svg",
                versions: [
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUlwtZjkY8Ah1wMJzYswvc3A1?pwd=a9tj", quark_url: "https://pan.quark.cn/s/a1d9eed05da8" },
                    { name: "2023版", xunlei_url: "https://pan.xunlei.com/s/VOUlxZbtTZcGjew392iQBgkEA1?pwd=77qr", quark_url: "https://pan.quark.cn/s/f42e5b631a7f" }
                ]
            },
            {
                name: "Acrobat",
                icon: "images/Acrobat_20DC.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUlyMvFjzTh3PleAWDYWfMXA1?pwd=th52", quark_url: "" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUlygK00BtpM3wdX2IggVSjA1?pwd=fzv5", quark_url: "https://pan.quark.cn/s/c16a0a97b3c1" }
                ]
            },
            {
                name: "After Effects",
                icon: "images/after-effects.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUlz3dfYiKY13FSSs2SC6_nA1?pwd=y2uw", quark_url: "https://pan.quark.cn/s/c1d512c07ac6" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUlzItJPuAvUvqziyTrNkTjA1?pwd=7tkp", quark_url: "https://pan.quark.cn/s/de2ee7622593" }
                ]
            },
            {
                name: "Animate",
                icon: "images/animate.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm1JpwCWikR9azGg3_7iC4A1?pwd=kw2v", quark_url: "https://pan.quark.cn/s/af926d70498f" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm1XEBCWikR9azGg3_7nJmA1?pwd=r3ce", quark_url: "https://pan.quark.cn/s/335ba83f34f9" }
                ]
            },
            {
                name: "Audition",
                icon: "images/audition.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm1kpom1Eo3LWHN6GC2jlvA1?pwd=udpb", quark_url: "https://pan.quark.cn/s/6460d6c4a99f" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm1x1cjsAyQQzfsqNYhaCEA1?pwd=qwgt", quark_url: "https://pan.quark.cn/s/8eecb7b4e850" }
                ]
            },
            {
                name: "Bridge",
                icon: "images/bridge.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm2D-Wp3uC6X071OZ3SgaLA1?pwd=5j2d", quark_url: "https://pan.quark.cn/s/088b8a679d05" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm2SCOp1CKbKjufLlfLVtjA1?pwd=die7", quark_url: "https://pan.quark.cn/s/c09143fc7452" }
                ]
            },
            {
                name: "Character Animator",
                icon: "images/character-animator.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm2jgTGzIHGhn5BJQE6p7uA1?pwd=h2sv", quark_url: "https://pan.quark.cn/s/7a0bbdc0ba27" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm3GjhIdoAuOdaS_cU0SorA1?pwd=x9rv", quark_url: "https://pan.quark.cn/s/5fd96f30cecc" }
                ]
            },
            {
                name: "Dimension",
                icon: "images/dimension.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm3_STJz_7b_HvN7tAvpu1A1?pwd=ar3a", quark_url: "https://pan.quark.cn/s/54827cb69d83" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm3tL-0BtpM3wdX2IgjcjpA1?pwd=zqvr", quark_url: "https://pan.quark.cn/s/183d0728b996" }
                ]
            },
            {
                name: "Dreamweaver",
                icon: "images/dreamweaver.svg",
                versions: [
                    { name: "2021版", xunlei_url: "https://pan.xunlei.com/s/VOUm4AqJ-sHBbrWfXCaiWavuA1?pwd=3fs7", quark_url: "https://pan.quark.cn/s/f3c2d6788a94" },
                    { name: "2020版", xunlei_url: "https://pan.xunlei.com/s/VOUm4Pq9k0ODxWrxP5OQsBM2A1?pwd=wnrr", quark_url: "https://pan.quark.cn/s/1f5bc911984e" }
                ]
            },
            {
                name: "Illustrator",
                icon: "images/illustrator.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm4fXxENW6mh3i9G3QmjSNA1?pwd=wpe2", quark_url: "https://pan.quark.cn/s/f39f4febf047" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm4sOwjzTh3PleAWDY_1ZIA1?pwd=qt2e", quark_url: "https://pan.quark.cn/s/75fa861f22f0" }
                ]
            },
            {
                name: "InCopy",
                icon: "images/incopy.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm57Sk-sHBbrWfXCaiX1n3A1?pwd=qa9j", quark_url: "https://pan.quark.cn/s/6f88371600c8" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm5Ksq0BtpM3wdX2IgkI8jA1?pwd=7dim", quark_url: "https://pan.quark.cn/s/dfcc3bca3614" }
                ]
            },
            {
                name: "InDesign",
                icon: "images/indesign.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm5av6TwpxJeVz1pyIlz3rA1?pwd=y6e2", quark_url: "https://pan.quark.cn/s/666e0a93ee13" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm5vRBPdtaaS6WBZj9J4PzA1?pwd=ssur", quark_url: "https://pan.quark.cn/s/fd4bb4fc0d4e" }
                ]
            },
            {
                name: "Lightroom Classic",
                icon: "images/lightroom-classic.svg",
                versions: [
                    { name: "lightroom-classic-14", xunlei_url: "https://pan.xunlei.com/s/VOUm68k8m1Eo3LWHN6GC4ioYA1?pwd=yzvx", quark_url: "https://pan.quark.cn/s/1fc2adeab368" },
                    { name: "lightroom-classic-13", xunlei_url: "https://pan.xunlei.com/s/VOUm6NpHjzTh3PleAWDY_jMTA1?pwd=r8zy", quark_url: "https://pan.quark.cn/s/b9eb3f914997" }
                ]
            },
            {
                name: "Media Encoder",
                icon: "images/media-encoder.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm6stW-MpLDNecwKuKciiPA1?pwd=cz7e", quark_url: "https://pan.quark.cn/s/21f19c2e5c4a" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm769esXvCNqGRW7voEyfTA1?pwd=wcg9", quark_url: "https://pan.quark.cn/s/765414040237" }
                ]
            },
            {
                name: "Photoshop",
                icon: "images/photoshop.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm7NxJSSuTaL_McwpRY8-HA1?pwd=hz7n", quark_url: "https://pan.quark.cn/s/00fa8f48979c" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm7hNr-z01v_D6GUhq5AVIA1?pwd=k3zt#", quark_url: "https://pan.quark.cn/s/8fadff8632d0" }
                ]
            },
            {
                name: "Photoshop Elements",
                icon: "images/Photoshop-Elements.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm84Zs0BtpM3wdX2IglWusA1?pwd=ef7f", quark_url: "https://pan.quark.cn/s/286f6af1be45" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm8MJyLvl3SwuGcyKm67MSA1?pwd=jetb", quark_url: "https://pan.quark.cn/s/1acc0443c723" }
                ]
            },
            {
                name: "Premiere Pro",
                icon: "images/premiere.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm8i-Rp3uC6X071OZ3V_VXA1?pwd=e5cm", quark_url: "https://pan.quark.cn/s/2e942b25ffc5" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm8xxNkQsTNTMiYiMul1g9A1?pwd=7ju2", quark_url: "https://pan.quark.cn/s/0abee26c5f09" }
                ]
            },
            {
                name: "Prelude",
                icon: "images/prelude.png",
                versions: [
                    { name: "2022版", xunlei_url: "https://pan.xunlei.com/s/VOUm9HIGkQsTNTMiYiMulCLxA1?pwd=i8wc", quark_url: "https://pan.quark.cn/s/b2c14ecb9fc8" },
                ]
            },
            {
                name: "Premiere Elements",
                icon: "images/premiere_elements.svg",
                versions: [
                    { name: "2025版", xunlei_url: "https://pan.xunlei.com/s/VOUm9TnXSSuTaL_McwpRZ8gpA1?pwd=vxnp", quark_url: "https://pan.quark.cn/s/d636cf5d29c4" },
                    { name: "2024版", xunlei_url: "https://pan.xunlei.com/s/VOUm9eG7rPBCn3Ck8YDyAFW1A1?pwd=wbr6", quark_url: "https://pan.quark.cn/s/f0bd88116bb9" }
                ]
            },
            {
                name: "Substance 3D",
                icon: "images/substance3D.svg",
                versions: [
                    { name: "Painter", xunlei_url: "https://pan.xunlei.com/s/VOUmA8okPdtaaS6WBZj9L6h_A1?pwd=zdj3", quark_url: "https://pan.quark.cn/s/361a0c3c57c7" },
                    { name: "Designer", xunlei_url: "https://pan.xunlei.com/s/VOUmALcJrPBCn3Ck8YDyAYgdA1?pwd=9aju", quark_url: "https://pan.quark.cn/s/9693dfd67e5f" }
                ]
            }
        ],
        office: [
            {
                name: "DaVinciResolve 达芬奇",
                icon: "images/DaVinciResolve.svg",
                versions: [
                    { name: "20X", xunlei_url: "https://pan.xunlei.com/s/VOUmLxDxrPBCn3Ck8YDyGCKPA1?pwd=mc8q", quark_url: "" },
                    { name: "19X", xunlei_url: "https://pan.xunlei.com/s/VOUmMtfQ334PJr-SVVZJn61BA1?pwd=mj72", quark_url: "https://pan.quark.cn/s/33aaf4e4b583" }
                ]
            }
        ]
    },
    "mac": {
        "photo": [
            {
                "name": "Mac版 Adobe全家桶",
                "icon": "images/adobe.svg",
                "versions": [
                    { "name": "2020", "xunlei_url": "https://pan.xunlei.com/s/VOUnV7-yMi09BdeolPW43ppAA1?pwd=knht", "quark_url": "https://pan.quark.cn/s/a1d9eed05da8" },
                     { "name": "2019", "xunlei_url": "https://pan.xunlei.com/s/VOUnW_PKxBcldmwAfK_6qhsAA1?pwd=hiw3", "quark_url": "https://pan.quark.cn/s/fc4542cd36de" }
                ]

            },
            {
                "name": "Mac版 Acrobat",
                "icon": "images/Acrobat_20DC.svg",
                "versions": [
                    { "name": "2024", "xunlei_url": "https://pan.xunlei.com/s/VOUnXBGaBrKOGyy1ySQIGIDAA1?pwd=8evh", "quark_url": "https://pan.quark.cn/s/cd12c4ef3941" }
                ]
            },
            {
                "name": "Mac版 After Effects",
                "icon": "images/after-effects.svg",
                "versions": [
                    { "name": "2025版", "xunlei_url": "https://pan.xunlei.com/s/VOUnYA5F81oyVXaRRTpqoZEwA1?pwd=darm", "quark_url": "" },
                    { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnYmHP90r0ejoDwIfENGzhA1?pwd=fbbz", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Animate",
                "icon": "images/animate.svg",
                "versions": [
                    { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnZ66jXKiT9VMV0p65ocVpA1?pwd=dw83", "quark_url": "" },
                    { "name": "2021 M1", "xunlei_url": "https://pan.xunlei.com/s/VOUnZOJuBoBkeySOVXiw2hvXA1?pwd=v6r8", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Audition",
                "icon": "images/audition.svg",
                "versions": [
                    { "name": "2025版", "xunlei_url": "https://pan.xunlei.com/s/VOUnXPri90r0ejoDwIfEM9y3A1?pwd=7tun", "quark_url": "" },
                      { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnXhTStBBMEBubvMR6v3gpA1?pwd=b8e3", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Bridge",
                "icon": "images/bridge.svg",
                "versions": [
                    { "name": "2025版", "xunlei_url": "https://pan.xunlei.com/s/VOUnZggHxBcldmwAfK_6sO7QA1?pwd=i9tn", "quark_url": "" },
                        { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnZzxH8_Ecbu1IjxHsFatbA1?pwd=we32", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Character Animator",
                "icon": "images/character-animator.svg",
                "versions": [
                    { "name": "2025版", "xunlei_url": "https://pan.xunlei.com/s/VOUn_MmZnStkEaRoRoM2ARTwA1?pwd=wrmf", "quark_url": "" },
                        { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUn_TqaPWmC90dN6KNkDYuTA1?pwd=g9iy", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Dimension",
                "icon": "images/dimension.svg",
                "versions": [
                    { "name": "2020 M1版", "xunlei_url": "https://pan.xunlei.com/s/VOUn_r_fNA9ZGgcDYE2opMWxA1?pwd=p2mr", "quark_url": "" },
                      { "name": "2020 ", "xunlei_url": "https://pan.xunlei.com/s/VOUn_yEKMi09BdeolPW473FoA1?pwd=vsi5", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Dreamweaver",
                "icon": "images/dreamweaver.svg",
                "versions": [
                    { "name": "2021版", "xunlei_url": "https://pan.xunlei.com/s/VOUnaH75zBp04DxXNs0RLafLA1?pwd=pwwv", "quark_url": "" },
                     { "name": "2020版", "xunlei_url": "https://pan.xunlei.com/s/VOUnadDkLr3E7E9ua8JHjX7-A1?pwd=ttsg", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Illustrator",
                "icon": "images/illustrator.svg",
                "versions": [
                    { "name": "2025版", "xunlei_url": "https://pan.xunlei.com/s/VOUnapOcsG4S2U3GAKHTyURPA1?pwd=5wsc", "quark_url": "" },
                       { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnb3THda5lOhqQo8_Dx8kwA1?pwd=vdwp", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 InCopy",
                "icon": "images/incopy.svg",
                "versions": [
                    { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnbEWF2yTMYT1ZhjlXN_0vA1?pwd=2k6e", "quark_url": "" },
                       { "name": "2021 M1版", "xunlei_url": "https://pan.xunlei.com/s/VOUnbVILPnKe3gVXieZJkfMgA1?pwd=zfah", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 InDesign",
                "icon": "images/indesign.svg",
                "versions": [
                    { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnbbJ7lcseGoWxvBEtu4ofA1?pwd=w368", "quark_url": "" },
                       { "name": "2021 M1版", "xunlei_url": "https://pan.xunlei.com/s/VOUnbmsetBBMEBubvMR6yML8A1?pwd=heu3", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Lightroom Classic",
                "icon": "images/lightroom-classic.svg",
                "versions": [
                    { "name": "14.01", "xunlei_url": "https://pan.xunlei.com/s/VOUncRQeDEf7YKINn7vMvffgA1?pwd=ujfu", "quark_url": "" },
                       { "name": "13", "xunlei_url": "https://pan.xunlei.com/s/VOUncWASXKiT9VMV0p65rCaJA1?pwd=aygk", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Media Encoder",
                "icon": "images/media-encoder.svg",
                "versions": [
                    { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUnc54sMQIyYIGhwrT2A5e2A1?pwd=evpb", "quark_url": "" },
                       { "name": "2021 M1版", "xunlei_url": "https://pan.xunlei.com/s/VOUnc9sJtBBMEBubvMR6yYmVA1?pwd=7xy2", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Photoshop",
                "icon": "images/photoshop.svg",
                "versions": [
                    { "name": "2025版", "xunlei_url": "https://pan.xunlei.com/s/VOUncqrGBoBkeySOVXiw5HWtA1?pwd=xxfp", "quark_url": "" },
                       { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUncw5e90r0ejoDwIfEQQOnA1?pwd=cqqs", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Prelude",
                "icon": "images/prelude.png",
                "versions": [
                    { "name": "2021 M1版", "xunlei_url": "https://pan.xunlei.com/s/VOUndIaUxRwqSp7vSxXpBXLcA1?pwd=fg4n", "quark_url": "" },
                       { "name": "2020 M1版", "xunlei_url": "https://pan.xunlei.com/s/VOUndMrkpTAUJoTkw9YNQ40iA1?pwd=awd3", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 Premiere",
                "icon": "images/premiere.svg",
                "versions": [
                    { "name": "2025版", "xunlei_url": "https://pan.xunlei.com/s/VOUne8FOxRwqSp7vSxXpBzU6A1?pwd=ensh", "quark_url": "" },
                       { "name": "2024版", "xunlei_url": "https://pan.xunlei.com/s/VOUneVGuWuimmS8V-ZpC_a8WA1?pwd=t5he", "quark_url": "" }
                ]
            },
            {
                "name": "Mac版 XD",
                "icon": "images/xd.svg",
                "versions": [
                    { "name": "2024", "xunlei_url": "https://pan.xunlei.com/s/VOUnes7iNK3JGlPrqa7ESzUxA1?pwd=5zm4", "quark_url": "" },
                       { "name": "2021版", "xunlei_url": "https://pan.xunlei.com/s/VOUney0YLr3E7E9ua8JHm3hgA1?pwd=afw8", "quark_url": "" }
                ]
            }

        ],
        office: [
            {
                name: "MAC版 DaVinciResolve 达芬奇",
                icon: "images/DaVinciResolve.svg",
                versions: [
                    { name: "19X", xunlei_url: "https://pan.xunlei.com/s/VOUo5F8sDEf7YKINn7vNCd_sA1?pwd=c8fm", quark_url: "" },
                    { name: "18X", xunlei_url: "https://pan.xunlei.com/s/VOUo6-Ovn92RZYQBlT7B5-egA1?pwd=bmnw", quark_url: "" }
                ]
            }
        ]

    }
};
// ==================== 数据中心结束 ====================


// ==================== 网站“引擎” - 最终升级版 ====================
document.addEventListener('DOMContentLoaded', () => {

    const osButtons = document.querySelectorAll('.os-button');
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContent = document.querySelector('.tab-content');
    const tabNav = document.querySelector('.tab-nav');
    const searchInput = document.getElementById('search-input');

    let currentOS = 'windows';
    let currentTabId = 'photo';

    // --- 核心渲染函数 (已升级，可隐藏空链接按钮) ---
    function renderItems(itemsArray, containerElement) {
        if (!containerElement) return;
        let htmlContent = '';
        if (itemsArray.length === 0) {
            htmlContent = '<p style="text-align: center; color: #888; padding: 20px;">该分类下暂无内容。</p>';
        } else {
            itemsArray.forEach(item => {
                htmlContent += `
                    <div class="collapsible-item">
                        <div class="item-header">
                            <img src="${item.icon}" alt="${item.name}" class="item-icon">
                            <span class="item-text">${item.name}</span>
                            <span class="item-arrow">&gt;</span>
                        </div>
                        <div class="item-content">
                            ${item.versions.map(version => `
                                <div class="download-row">
                                    <span class="version-name">${item.name} ${version.name}</span>
                                    <div class="button-group">
                                        ${version.xunlei_url ? `<a href="${version.xunlei_url}" target="_blank" class="download-button thunder">迅雷下载</a>` : ''}
                                        ${version.quark_url ? `<a href="${version.quark_url}" target="_blank" class="download-button quark">夸克网盘</a>` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
        }
        containerElement.innerHTML = htmlContent;
    }

    // --- 更新整个页面的函数 ---
    function updatePageContent() {
        const activePanel = document.getElementById(currentTabId);
        if (!activePanel) return;
        const dataToShow = (database[currentOS] && database[currentOS][currentTabId]) ? database[currentOS][currentTabId] : [];
        renderItems(dataToShow, activePanel);
    }

    // --- 事件处理逻辑 ---

    // 1. 操作系统切换按钮
    osButtons.forEach(button => {
        button.addEventListener('click', () => {
            currentOS = button.dataset.os;
            osButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            updatePageContent();
        });
    });

    // 2. 标签页切换
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            currentTabId = button.dataset.tab;
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            document.querySelectorAll('.content-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            const targetPanel = document.getElementById(currentTabId);
            if (targetPanel) {
                targetPanel.classList.add('active');
                updatePageContent();
            }
        });
    });

    // 3. 列表项折叠 (手风琴效果)
    tabContent.addEventListener('click', function(event) {
        const clickedHeader = event.target.closest('.item-header');
        if (!clickedHeader) return;
        const currentContent = clickedHeader.nextElementSibling;
        if (!currentContent) return;
        const isOpening = !currentContent.classList.contains('open');
        const allContents = clickedHeader.closest('.content-panel').querySelectorAll('.item-content');
        allContents.forEach(content => {
            if (content !== currentContent) {
                content.classList.remove('open');
                if(content.previousElementSibling) {
                    content.previousElementSibling.classList.remove('active');
                }
            }
        });
        if (isOpening) {
            clickedHeader.classList.add('active');
            currentContent.classList.add('open');
        } else {
             clickedHeader.classList.remove('active');
             currentContent.classList.remove('open');
        }
    });

    // 4. 实时搜索逻辑
    searchInput.addEventListener('input', function() {
        const searchTerm = this.value.trim().toLowerCase();
        const activePanel = document.querySelector('.content-panel.active');
        if (!activePanel) return;
        if (searchTerm === '') {
            tabNav.style.display = 'block';
            updatePageContent();
            return;
        }
        tabNav.style.display = 'none';
        const searchResults = [];
        if (database[currentOS]) {
            for (const category in database[currentOS]) {
                if(database[currentOS][category]) {
                    database[currentOS][category].forEach(item => {
                        if (item.name.toLowerCase().includes(searchTerm)) {
                            searchResults.push(item);
                        }
                    });
                }
            }
        }
        renderItems(searchResults, activePanel);
    });

    // --- 页面加载时，默认初始化 ---
    function initialize() {
        // ... (初始化逻辑和之前一样)
        const initialOsButton = document.querySelector(`.os-button[data-os="${currentOS}"]`);
        if (initialOsButton) initialOsButton.classList.add('active');
        const initialTabButton = document.querySelector(`.tab-button[data-tab="${currentTabId}"]`);
        if (initialTabButton) initialTabButton.classList.add('active');
        const initialPanel = document.getElementById(currentTabId);
        if (initialPanel) {
             initialPanel.classList.add('active');
             updatePageContent();
        }
    }

    initialize();
});
// ==================== 引擎结束 ====================